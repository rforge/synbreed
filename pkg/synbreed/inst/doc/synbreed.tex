%\VignetteIndexEntry{Getting started with the package}
%\VignetteKeywords{getting started}
%\VignettePackage{synbreed}

\documentclass[a4paper,11pt]{article}
\usepackage{natbib}
\bibliographystyle{apalike}

% Preabmle parts
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage{hyperref}
\usepackage{times}

%PSTricks
\usepackage{pdftricks}
\begin{psinputs}
  \usepackage{pst-all}
\end{psinputs}

\usepackage{bm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{latexsym}
\usepackage{verbatim}
\usepackage{epsfig}
\usepackage{comment}
\usepackage{pdfpages}
%\usepackage{algorithm2e}
\usepackage{subfigure}

\usepackage{Sweave}
\usepackage{fancyvrb}
\definecolor{Sinput}{rgb}{0.56,0,0}
\DefineVerbatimEnvironment{Sinput}{Verbatim}{formatcom={\color{Sinput}},fontsize=\small,fontshape=sl}
\definecolor{Soutput}{rgb}{0,0,0.56}
\DefineVerbatimEnvironment{Soutput}{Verbatim}{formatcom={\color{Soutput}},fontsize=\small,fontshape=sl}

\newcommand{\Cov}{\text{Cov}}


\title{The R-Package 'synbreed'}
\author{
Valentin Wimmer\thanks{Author of correspondence. Contact: Institute for plant breeding, Technische Universität München, Emil-Ramann-Str. 4,
	85354 Freising, Germany, Email: \texttt{Valentin.Wimmer@wzw.tum.de}}\\
} \date{\today}

\begin{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Sweave
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Put all in another directory

 \setkeys{Gin}{width=0.9\textwidth}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Initial R code
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




\maketitle


\begin{abstract}
  \noindent This document gives an introduction to the R-package
  \texttt{synbreed}. This package implements statistical and genetic methods
               for plant and animal breeding. The goal is to create an analysis pipeline for genomic selection. This comprises tools
  for genotypic, phenotypic and pedigree data. The steps of a typical analysis are presented in this document. This starts with the coding of the marker data, followed by the estimation of relatdness according
  to pedigree or molecular marker data, e.g. according to \citet{vanRaden2008}. Finally the estimation of breeding values and estimation of variance components using mixed models is described. 
  All steps are illustrated using simulated data for maize.\\

  \noindent{\bf Keywords:} synergistic plant and animal breeding, simulation, pedigree, genomic marker data, mixed models, genomic selection
  

  
\end{abstract}


\section{Introduction}\label{sec:Introduction}

The R-package \texttt{synbreed} aims to provide the tools that are necessary to analyze data of breeding programs and estimate (genomic) breeding values. Of course,
there exists already software for this purpose. In R, package \texttt{genetics} contains classes and methods for handling genetic data \citep{Warnes2003}. Note that R-Genetics project has developed an set of enhanced genetics
  packages to replace \texttt{genetics} (\url{http://rgenetics.org}). Package \texttt{qtl} could be used for QTL analysis in experimental crosses \citep{Broman2003}. Library \texttt{GenABEL} is designed for genome-wide association analysis and effective SNP data storage and manipulation \citep{Aulchenko2007}.

 The idea of this package is to collect the methods in one package, so that analysis can be performed in one software with just a few steps as described in this document.  Additional, this package takes care of special problems of modern breeding programs as the use of doubled haploid (DH) lines in plant breeding.  To our knowledge, there is no package in R which provides comparable features. Most of packages source code is written in R, so that methods could easily be adopted for own purposes. Package \texttt{synbreed} makes no stringent restriction concerning input data format to allow for a wide range of possible data sources.

Modern breeding programs use genomic information of individuals. On the genomic level, individuals could be distinguished by \textit{alleles} which are different states at a particular gene locus. In diploid species, every individuals has two sets of chromosomes and thus two copies of each allele at a locus. 
If both alleles are the same, the individual is homozygous for this locus, otherwise it heterozygous. For many species  \textit{molecular markers} are available and used to detect SNP (single nucleotide polymorphism) variation which occurs when a single nucleotide (\texttt{A}, \texttt{T}, \texttt{C}, or \texttt{G}) differs between individuals.
 In this document, the term \textit{genotype} refers to an individual's set of alleles read by molecular markers and is used as a synonym for an individual. On the other hand, \textit{phenotype} denotes the observed and measured value of a genotype, i.e. a trait
of commercial interest. It is assumed that the phenotype is determined by a certain degree the genotype and by the environment.

The idea to use molecular markers in breeding is to predict genomic breeding values for the individuals based on  marker information. In case a dense marker map is available, all quantitative
trait loci (QTL) are assumed to be in linkage with at least one
marker. To obtain genetic breeding values, \citet{Meuwissen2001} proposed to regress the phenotype on the markers (genotype). Once the model is available, individuals with a favorable set of genes are selected for the next cycle in breeding program. This is called \textit{genomic selection}.

The remainder of this document is structured as follows. In section \ref{sec:ExampleData} a simulated data set is presented which is used to illustrate the methods in this document. Section \ref{sec:MarkerData} describes the coding of marker data and imputing for missing genotypic data. 
In Section \ref{sec:LinkageDisequilibrium} is shown how Linkage Disequilibrium (LD) between markers could be computed and visualized using \texttt{synbreed} package.  
Section \ref{sec:Pedigree} shows how to utilize pedigree information. In Section \ref{sec:theory} basic concepts of quantitative genetics are introduced. Section \ref{sec:RelationshipMatrices} presents several methods to estimate relatedness between individuals. 
In section \ref{sec:Models} the use of mixed models to estimate variance components and breeding values is illustrated. Section \ref{sec:genomicSelection} presents full analysis pipeline for genomic selection comparing different models  using simulated data.


\section{Example data}\label{sec:ExampleData}

In this document the steps of an analysis pipeline for genotypic and phenotypic data in plant or animal breeding with the R-package \texttt{synbreed} are presented. For illustration, a the package contains a simulated data set for maize, called \texttt{maize}. This data set could be used to test performance of methods because estimated values could easily be compared with specified parameters of the simulation (position of QTL, size of marker effects, true breeding values for individuals).
To load \texttt{maize} data, use
\begin{Schunk}
\begin{Sinput}
> library(synbreed)
> data(maize)
\end{Sinput}
\end{Schunk}
